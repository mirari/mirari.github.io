import{_ as o}from"./ValaxyMain.vue_vue_type_style_index_0_lang-BWN6FZjJ.js";import{f as d,w as a,e as c,A as g,ag as r,o as y,a as i,H as s,U as t}from"./app-O6veFoRw.js";import"./YunComment.vue_vue_type_style_index_0_lang-BdmCVZ97.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-6OskRlK9.js";import"./post-CxZOEfth.js";const A={__name:"2023-06-02-pitfalls_of_migrating_wechat_mini_program_to_alipay",setup(u,{expose:p}){const e=JSON.parse('{"title":"微信小程序迁移支付宝踩坑","description":"","frontmatter":{"title":"微信小程序迁移支付宝踩坑","categories":["学习笔记"],"tags":["小程序","支付宝"],"date":"2023-06-02 11:15:15"},"headers":[{"level":3,"title":"样式隔离","slug":"样式隔离","link":"#样式隔离","children":[]},{"level":3,"title":"样式兼容","slug":"样式兼容","link":"#样式兼容","children":[]},{"level":3,"title":"获取子组件 selectComponent","slug":"获取子组件-selectcomponent","link":"#获取子组件-selectcomponent","children":[]},{"level":3,"title":"子组件的点击","slug":"子组件的点击","link":"#子组件的点击","children":[]},{"level":3,"title":"npm的使用","slug":"npm的使用","link":"#npm的使用","children":[]},{"level":3,"title":"Behavior","slug":"behavior","link":"#behavior","children":[]},{"level":3,"title":"复制到剪贴板api","slug":"复制到剪贴板api","link":"#复制到剪贴板api","children":[]},{"level":3,"title":"查找元素 createSelectorQuery","slug":"查找元素-createselectorquery","link":"#查找元素-createselectorquery","children":[]},{"level":3,"title":"可选操作符","slug":"可选操作符","link":"#可选操作符","children":[]},{"level":3,"title":"导航栏","slug":"导航栏","link":"#导航栏","children":[]},{"level":3,"title":"Antmove处理","slug":"antmove处理","link":"#antmove处理","children":[]},{"level":3,"title":"客服按钮","slug":"客服按钮","link":"#客服按钮","children":[]},{"level":3,"title":"分享 showShareMenu","slug":"分享-showsharemenu","link":"#分享-showsharemenu","children":[]},{"level":3,"title":"数据变化观测器 observer","slug":"数据变化观测器-observer","link":"#数据变化观测器-observer","children":[]}],"relativePath":"pages/posts/2023-06-02-pitfalls_of_migrating_wechat_mini_program_to_alipay.md","path":"/home/runner/work/blog/blog/pages/posts/2023-06-02-pitfalls_of_migrating_wechat_mini_program_to_alipay.md","lastUpdated":1733198069000}'),n=g(),h=e.frontmatter||{};return n.meta.frontmatter=Object.assign(n.meta.frontmatter||{},e.frontmatter||{}),r("pageData",e),r("valaxy:frontmatter",h),globalThis.$frontmatter=h,p({frontmatter:{title:"微信小程序迁移支付宝踩坑",categories:["学习笔记"],tags:["小程序","支付宝"],date:"2023-06-02 11:15:15"}}),(l,k)=>{const E=o;return y(),d(E,{frontmatter:c(h)},{"main-content-md":a(()=>k[0]||(k[0]=[i("p",null,"需要迁移的小程序是原生的微信小程序，涉及大量微信小程序的原生api和功能，工作量不小。",-1),i("p",null,[s("首先还是要用到迁移工具"),i("a",{href:"https://ant-move.github.io/",target:"_blank",rel:"noreferrer"},"Antmove"),s("，可惜这个工具已经多年未更新，生成的代码必然是没法直接运行的，而且后来的使用中发现，有一些支付宝原本不支持的功能做了降级适配，实际上现在已经支持了，而Antmove做的处理反而会出问题。")],-1),i("p",null,"基础的迁移操作和差异对比可参考以下文章：",-1),i("p",null,[i("a",{href:"https://juejin.cn/post/6844904178012127246",target:"_blank",rel:"noreferrer"},"一些微信小程序和支付宝小程序对应的差异")],-1),i("p",null,[i("a",{href:"https://blog.csdn.net/weixin_41476562/article/details/127331168",target:"_blank",rel:"noreferrer"},"微信小程序迁移到支付宝记坑")],-1),i("p",null,"这边只记录我遇到的问题：",-1),i("h3",{id:"样式隔离",tabindex:"-1"},[s("样式隔离 "),i("a",{class:"header-anchor",href:"#样式隔离","aria-label":'Permalink to "样式隔离"'},"​")],-1),i("p",null,"目前只能做到自身不影响外部，但外部始终能影响内部。",-1),i("p",null,"因此所有自定义组件的样式如果起得过于简单，一旦冲突，都需要重新命名。",-1),i("p",null,"如果有的页面样式很多，其中有些希望影响内部，有些又不希望影响的话，只能重命名那些不希望影响组件的，确保样式名唯一。",-1),i("p",null,[i("a",{href:"https://opendocs.alipay.com/mini/framework/page-acss#%E9%A1%B5%E9%9D%A2%E6%A0%B7%E5%BC%8F%E9%9A%94%E7%A6%BB",target:"_blank",rel:"noreferrer"},"页面样式隔离")],-1),i("p",null,[i("a",{href:"https://open.alipay.com/portal/forum/post/79501017",target:"_blank",rel:"noreferrer"},"如何防止页面样式影响到组件内部？")],-1),i("h3",{id:"样式兼容",tabindex:"-1"},[s("样式兼容 "),i("a",{class:"header-anchor",href:"#样式兼容","aria-label":'Permalink to "样式兼容"'},"​")],-1),i("p",null,[i("code",null,"background-image"),s("不支持，需要改为image组件写法。")],-1),i("h3",{id:"获取子组件-selectcomponent",tabindex:"-1"},[s("获取子组件 selectComponent "),i("a",{class:"header-anchor",href:"#获取子组件-selectcomponent","aria-label":'Permalink to "获取子组件 selectComponent"'},"​")],-1),i("p",null,[s("Antmove抹平了查找子组件的差异，从而保留了"),i("code",null,"selectComponent(s)"),s("方法。")],-1),i("p",null,[s("由于要尽量保留微信原生写法，这里后面提到的获取子组件都指的是包装过的"),i("code",null,"selectComponent"),s("。")],-1),i("h4",{id:"生命周期",tabindex:"-1"},[s("生命周期 "),i("a",{class:"header-anchor",href:"#生命周期","aria-label":'Permalink to "生命周期"'},"​")],-1),i("p",null,[s("在生命周期的onLoad和onShow时不能使用查找子组件，此时拿不到对象，需要套一层"),i("code",null,"setTimeout(() => {}, 0)")],-1),i("h4",{id:"抽象节点",tabindex:"-1"},[s("抽象节点 "),i("a",{class:"header-anchor",href:"#抽象节点","aria-label":'Permalink to "抽象节点"'},"​")],-1),i("p",null,"无法获取到抽象节点，只能改写法，使用ref来实现，参考如下：",-1),i("div",{class:"language-html vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"html"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},`abstracta:for='{{list}}'ref="refNavList"id='nav_list'a:key='{{categoryId}}'a:if='{{index===selected}}'item='{{item}}'ref-numbers='{{list}}'onOnClickCard='onClickCard'`),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"abstract"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"collapse"})],-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMore"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  constlist"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".$navList")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(list){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  list."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMore"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"},")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"refNavList"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ref){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  //存储自定义组件实例，方便以后调用")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".$navList"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ref;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"},")])])]),i("button",{class:"collapse"})],-1),i("h3",{id:"子组件的点击",tabindex:"-1"},[s("子组件的点击 "),i("a",{class:"header-anchor",href:"#子组件的点击","aria-label":'Permalink to "子组件的点击"'},"​")],-1),i("p",null,[s("直接写"),i("code",null,'<foo onTap="onTap">'),s("是无法触发的。需要在自定义组件外面套一层view再加点击事件，或者自定义组件做转发：")],-1),i("div",{class:"language-html vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"html"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"view"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," class"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"子组件最外层的view"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," onTap"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"onTap"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">...</"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"view"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"collapse"})],-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    onTap"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (e) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"      this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"triggerEvent"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'tap'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", e);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")])])]),i("button",{class:"collapse"})],-1),i("blockquote",null,[i("p",null,"注意：自定义组件的事件（如 onTap 等），并不是每个自定义组件默认支持的，需要自定义组件本身明确支持才能使用。")],-1),i("h3",{id:"npm的使用",tabindex:"-1"},[s("npm的使用 "),i("a",{class:"header-anchor",href:"#npm的使用","aria-label":'Permalink to "npm的使用"'},"​")],-1),i("p",null,"在微信中使用npm库，开发工具会将npm库的入口文件重新打包输出并放到转换目录对应文件夹的根路径下。",-1),i("p",null,"而在支付宝中，npm包在引入后不会出现转换目录，而是直接使用node_modules下的代码了。",-1),i("p",null,"因此如果代码中出现了对npm的引用，其引入路径全部都需要更改。",-1),i("p",null,"考虑到有些npm库的代码也是原生微信小程序的，同样需要转换代码，最终的处理方案是将所有npm包都手动拷贝到指定目录，一起参与antmove的转换，并手动修改所有涉及的引入路径。",-1),i("h3",{id:"behavior",tabindex:"-1"},[s("Behavior "),i("a",{class:"header-anchor",href:"#behavior","aria-label":'Permalink to "Behavior"'},"​")],-1),i("p",null,[s("支付宝中不存在该对象，只能用"),i("code",null,"Mixin"),s("对象和"),i("code",null,"mixins"),s("属性平替。")],-1),i("h3",{id:"复制到剪贴板api",tabindex:"-1"},[s("复制到剪贴板api "),i("a",{class:"header-anchor",href:"#复制到剪贴板api","aria-label":'Permalink to "复制到剪贴板api"'},"​")],-1),i("p",null,[s("不知道出于什么实际原因，文档里虽然还有，但该接口"),i("strong",null,"已废弃"),s("。小程序中如果有类似需求，只能舍弃。")],-1),i("blockquote",null,[i("p",null,[s("目前"),i("code",null,"my.setClipboard"),s("这个api支付宝开放平台文档已下架，已不支持使用")])],-1),i("p",null,[i("a",{href:"https://open.alipay.com/portal/forum/post/55401022",target:"_blank",rel:"noreferrer"},"my.setClipboard 在预览和真机调试下无效")],-1),i("h3",{id:"查找元素-createselectorquery",tabindex:"-1"},[s("查找元素 createSelectorQuery "),i("a",{class:"header-anchor",href:"#查找元素-createselectorquery","aria-label":'Permalink to "查找元素 createSelectorQuery"'},"​")],-1),i("p",null,"与微信不同，不支持查询子组件内部元素的位置信息，只能查原生组件的。",-1),i("p",null,[s("所以需要改变写法，先在子组件上实现一个"),i("code",null,"createSelectorQuery"),s("相关逻辑，然后让父组件用"),i("code",null,"selectComponent"),s("获取子组件，再执行其方法获取结果。")],-1),i("p",null,[s("另外Antmove对"),i("code",null,"createSelectorQuery"),s("做了兼容性处理，因为早期的支付宝原生方法不支持局部查询，所以使用"),i("code",null,"this.createSelectorQuery"),s("时也会变成全局查询。现在的版本需要移除此适配。")],-1),i("h3",{id:"可选操作符",tabindex:"-1"},[s("可选操作符 "),i("a",{class:"header-anchor",href:"#可选操作符","aria-label":'Permalink to "可选操作符"'},"​")],-1),i("p",null,[s("比如"),i("code",null,"a?.b"),s("和"),i("code",null,"a ?? b"),s("语法目前都不支持，据说2023年6月后会支持。")],-1),i("p",null,[s("目前只能手动改成"),i("code",null,"&&"),s("和"),i("code",null,"||"),s("。")],-1),i("h3",{id:"导航栏",tabindex:"-1"},[s("导航栏 "),i("a",{class:"header-anchor",href:"#导航栏","aria-label":'Permalink to "导航栏"'},"​")],-1),i("h4",{id:"不能隐藏返回、首页按钮",tabindex:"-1"},[s("不能隐藏返回、首页按钮 "),i("a",{class:"header-anchor",href:"#不能隐藏返回、首页按钮","aria-label":'Permalink to "不能隐藏返回、首页按钮"'},"​")],-1),i("p",null,"不能完全自由地用脚本控制返回、首页按钮的显隐。因此，原本在微信上自定义过返回、首页按钮的自定义导航栏，只能改回系统按钮。",-1),i("p",null,"以下是官方回复：",-1),i("p",null,"Q：导航栏左上角的 “返回小程序首页” 按钮和 “返回上一页” 按钮何时会展示？",-1),i("p",null,"A：当页面为最底层页面（页面栈深度为 1 ），且页面为非首页、非 tabBar 页面时，标题栏左上角默认展示 “返回首页” 按钮； 当页面栈深度大于 1 时，默认展示 “返回上一页” 按钮 页面栈 是小程序框架管理界面的方式，可以使用 my.getCurrentPages().length 查看当前页面栈深度。",-1),i("p",null,"Q：如何隐藏标题栏上的返回按钮？",-1),i("p",null,"A：暂无 API 可以直接隐藏页面的返回上一页按钮；可以先通过 my.reLaunch 进行页面跳转，使用页面栈深度为 1，返回上一页按钮自然隐藏。如有必要，在目标页面里调用 my.hideBackHome，将返回小程序首页按钮也隐藏掉。",-1),i("p",null,"而用于获取左侧按钮和右侧菜单按钮的api写得像是一坨屎，有很多历史包袱，且没有官方示例。",-1),i("p",null,"以下是我的代码供参考：",-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"export"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," function"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getHeader"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," () {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    const"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        titleBarHeight"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        statusBarHeight"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSystemInfoSync"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    let"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," titleBarLeft "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 30")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"canIUse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'getLeftButtonsBoundingClientRect'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        const"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            backButtonIcon"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            backButtonInteractive"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            homeButtonIcon"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLeftButtonsBoundingClientRect"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        titleBarLeft "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (homeButtonIcon) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            titleBarLeft "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," homeButtonIcon.right")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (backButtonInteractive) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            titleBarLeft "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," backButtonInteractive.right")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        titleBarHeight,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        statusBarHeight,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        titleBarLeft,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1),i("h4",{id:"不能自定义前景色",tabindex:"-1"},[s("不能自定义前景色 "),i("a",{class:"header-anchor",href:"#不能自定义前景色","aria-label":'Permalink to "不能自定义前景色"'},"​")],-1),i("p",null,[s("首先，在页面的json配置文件中只能修改背景色"),i("code",null,"backgroundColor"),s("。微信上的前景色属性"),i("code",null,"titleBarColor"),s("并不会生效。")],-1),i("p",null,[s("而背景色只要不为白色"),i("code",null,"#FFFFFF"),s("时，前景色就会被强制固定为白色。")],-1),i("p",null,[s("我这里原本的UI配色是将背景色设置为较浅的灰色"),i("code",null,"#F7F7F7"),s("，结果标题文字变成白色完全看不清。")],-1),i("p",null,"解决方案是把导航栏的颜色配置挪到onLoad时用脚本修改：",-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setNavigationBar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  backgroundColor:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'#f7f7f7'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  frontColor:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'#333333'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"})")])])]),i("button",{class:"collapse"})],-1),i("p",null,[s("然后又发现前景色"),i("code",null,"frontColor"),s("实际上只接受黑白两种色值。 这个写法会提示不合法，只能把"),i("code",null,"frontColor"),s("改为"),i("code",null,"#000000")],-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"wx."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setNavigationBar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  backgroundColor: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'#f7f7f7'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  frontColor: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'#000000'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"})")])])]),i("button",{class:"collapse"})],-1),i("h3",{id:"antmove处理",tabindex:"-1"},[s("Antmove处理 "),i("a",{class:"header-anchor",href:"#antmove处理","aria-label":'Permalink to "Antmove处理"'},"​")],-1),i("h4",{id:"mixins",tabindex:"-1"},[s("mixins "),i("a",{class:"header-anchor",href:"#mixins","aria-label":'Permalink to "mixins"'},"​")],-1),i("p",null,"支付宝现在已原生支持，但antmove做了适配，反而导致不兼容。",-1),i("p",null,[s("需要到"),i("code",null,"__antmove/component/classSubdirectory/component.js"),s("找到以下代码，注释掉对"),i("code",null,"options.mixins"),s("属性的删除")],-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," behaviors"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," options.behaviors "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"||"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," []")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," mixins"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," options.mixins "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"||"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," []")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," _export"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," options.export "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"||"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ''")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"delete"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," options.behaviors")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// delete options.mixins")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," retMixins"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_opts.observerObj "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_opts.observersObj "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_opts.behaviorsArr "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," []")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"processBehavior"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(retMixins, behaviors, _opts.behaviorsArr)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"processBehavior"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(retMixins, mixins, _opts.behaviorsArr)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mergeOptions"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(retMixins, options)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"processBehaviorId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(behaviors)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"processBehaviorId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mixins)")])])]),i("button",{class:"collapse"})],-1),i("h4",{id:"createselectorquery",tabindex:"-1"},[s("createSelectorQuery "),i("a",{class:"header-anchor",href:"#createselectorquery","aria-label":'Permalink to "createSelectorQuery"'},"​")],-1),i("p",null,"支付宝现在已原生支持，但antmove做了适配，反而导致不兼容。",-1),i("p",null,[s("需要到"),i("code",null,"__antmove/component/classSubdirectory/component.js"),s("找到以下代码，注释掉对"),i("code",null,"createSelectorQuery"),s("的包装。")],-1),i("div",{class:"language-javascript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"javascript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fnApp."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insert"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'onInit'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"function"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"      this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".__wxExparserNodeId__ "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," nextUid"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // processIntersectionObserver(this)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // this.createSelectorQuery = function() {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      //   if (config.env !== 'production') {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      //     console.warn(")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      //       '支付宝createSelectorQuery不支持限定选择器的选择范围，如使用，请保证对应选择器使用的唯一性',")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      //     )")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      //   }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      //   return createSelectorQuery.fn()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"      for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," method"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"typeof"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[method] "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"==="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'function'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"          this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[method] "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[method]."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")])])]),i("button",{class:"collapse"})],-1),i("h3",{id:"客服按钮",tabindex:"-1"},[s("客服按钮 "),i("a",{class:"header-anchor",href:"#客服按钮","aria-label":'Permalink to "客服按钮"'},"​")],-1),i("p",null,"微信现在有好几种形式发起客服，比如企业微信，但支付宝下只有一种，就是放个按钮让用户点击。",-1),i("p",null,"需要覆写这个按钮的样式才能实现UI适配，否则很丑。",-1),i("p",null,"为了有一个清晰且低耦合的页面结构，更好的做法是自定义样式后，把一个透明的客服按钮盖在上面。",-1),i("p",null,[s("这样客服按钮可以有多种表现形式，而接入写法很简单，在响应范围最外层加上"),i("code",null,"contact-button-wrapper"),s("样式，再在内部最末尾加上"),i("code",null,"contact-button"),s("即可。")],-1),i("p",null,"参考如下:",-1),i("div",{class:"language-css vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".contact-button-wrapper"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    position"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"relative"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".contact-button-wrapper"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}}," contact-button"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    width"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"%"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    height"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"%"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    position"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"absolute"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    left"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    top"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    opacity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    z-index"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1),i("div",{class:"language-html vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"html"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"view"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," class"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"contact-button-wrapper"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  如遇到定位不准确等问题，请<"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"text"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," class"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'text-primary'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">联系客服</"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"text"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"contact-button")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    tnt-inst-id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"你的客服id"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    scene"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"你的客服scene"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  />")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"view"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"collapse"})],-1),i("h3",{id:"分享-showsharemenu",tabindex:"-1"},[s("分享 showShareMenu "),i("a",{class:"header-anchor",href:"#分享-showsharemenu","aria-label":'Permalink to "分享 showShareMenu"'},"​")],-1),i("p",null,"在微信中由于限制滥用，从某个时间点起这个按钮已经不具备弹出分享页面的功能了，只是控制右上角分享按钮是否展示。",-1),i("p",null,"用户只能通过open-type的按钮和右上角来手动操作打开分享页面。",-1),i("p",null,"但是文档始终没有修改，容易引起误会。",-1),i("p",null,"但支付宝中，这个api仍然可以唤起分享页面，并且没有操作来源的限制。",-1),i("p",null,"而且文档删除了showShareMenu，改名为showSharePanel，但前者仍然可用。",-1),i("p",null,"因此在微信中习惯性地在onShow回调里打开右上角分享按钮，在支付宝中会变成弹出分享页面。",-1),i("p",null,"需要删除该语句。",-1),i("h3",{id:"数据变化观测器-observer",tabindex:"-1"},[s("数据变化观测器 observer "),i("a",{class:"header-anchor",href:"#数据变化观测器-observer","aria-label":'Permalink to "数据变化观测器 observer"'},"​")],-1),i("p",null,"支付宝已原生支持。",-1),i("p",null,"但某些场景的表现与微信有不同，需要仔细检查。比如：",-1),i("p",null,"页面属性a有一个数组子属性b，这个数组b被子组件监听。",-1),i("p",null,[s("当数组成员"),i("code",null,"b[c]"),s("被修改时，observe不会触发。")],-1),i("p",null,[s("数组被重新赋值"),i("code",null,"b = [...b]"),s("，也不会触发。")],-1),i("p",null,[s("页面属性被旧对象组装后重新赋值"),i("code",null,"a = {...a, b}"),s("，也不会触发。")],-1),i("p",null,"只有该页面属性被全新对象赋值时才会触发。(怀疑跟diff算法有关)",-1),i("p",null,[s("因此在所有值变化结束后，需要靠"),i("code",null,"lodash.deepCopy"),s("复制对象，然后重新setData。")],-1)])),"main-header":a(()=>[t(l.$slots,"main-header")]),"main-header-after":a(()=>[t(l.$slots,"main-header-after")]),"main-nav":a(()=>[t(l.$slots,"main-nav")]),"main-content":a(()=>[t(l.$slots,"main-content")]),"main-content-after":a(()=>[t(l.$slots,"main-content-after")]),"main-nav-before":a(()=>[t(l.$slots,"main-nav-before")]),"main-nav-after":a(()=>[t(l.$slots,"main-nav-after")]),comment:a(()=>[t(l.$slots,"comment")]),footer:a(()=>[t(l.$slots,"footer")]),aside:a(()=>[t(l.$slots,"aside")]),"aside-custom":a(()=>[t(l.$slots,"aside-custom")]),default:a(()=>[t(l.$slots,"default")]),_:3},8,["frontmatter"])}}};export{A as default};
